<!DOCTYPE html>
<html lang="en">
{% load static %}
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - FinanceAI</title>
    <link rel="icon" type="image/png" href="{% static 'stock.png' %}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- Top Navbar -->
    <nav class="navbar">
        <div class="navbar-content">
            <a href="{% url 'index' %}" class="logo">
                <div class="logo-icon logo-icon-chart">
                    <svg class="logo-icon-svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 17l5-5 4 4 9-9"/><path d="M21 12v6h-6"/></svg>
                </div>
                <span class="gradient-text">FinanceAI</span>
            </a>
            <div style="display: flex; align-items: center; gap: 20px;">
                <span id="user-name" style="color: var(--text-secondary); font-size: 14px;">Welcome, User</span>
                <button onclick="logout()" class="btn btn-secondary" style="padding: 8px 16px; font-size: 13px;">
                    Sign Out
                </button>
            </div>
        </div>
    </nav>

    <!-- Sidebar -->
    {% include 'includes/sidebar.html' with active='dashboard' %}

    <!-- Main Content -->
    <main class="main-content">
        <div class="page-header">
            <h1 class="page-title">Dashboard Overview</h1>
            <p class="page-subtitle">Track your financial performance and AI insights</p>
        </div>

        <!-- Stats Cards -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">Portfolio Value</div>
                <div class="stat-value" id="portfolio-value">$124,532.80</div>
                <div class="stat-change positive" id="portfolio-change">
                    <span id="portfolio-change-arrow">↑</span>
                    <span id="portfolio-change-text">+5.23% ($6,182)</span>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-label">Risk Score</div>
                <div class="stat-value" style="color: var(--accent-orange);">68%</div>
                <div class="stat-change" style="color: var(--accent-orange);">
                    <span>Moderate Risk</span>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-label">Prediction Accuracy</div>
                <div class="stat-value" style="color: var(--accent-green);">72%</div>
                <div class="stat-change positive">
                    <span>↑</span>
                    <span>+3% this month</span>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-label">News Sentiment</div>
                <div class="stat-value" style="color: var(--accent-cyan);">Bullish</div>
                <div class="stat-change positive">
                    <span>↑</span>
                    <span>+12% positive</span>
                </div>
            </div>
        </div>

        <!-- Markets (live updating every 2s) -->
        <div class="glass-card dashboard-markets-card" style="padding: 24px; margin-bottom: 24px;">
            <h3 style="margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="color: var(--accent-green);"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/></svg>
                Markets
            </h3>
            <div class="dashboard-markets-grid">
                <div class="dashboard-markets-item" data-market="nifty">
                    <span class="dashboard-markets-name">NIFTY</span>
                    <span class="dashboard-markets-value">25,496.55</span>
                    <span class="dashboard-markets-change positive">+0.06%</span>
                </div>
                <div class="dashboard-markets-item" data-market="sensex">
                    <span class="dashboard-markets-name">SENSEX</span>
                    <span class="dashboard-markets-value">82,248.61</span>
                    <span class="dashboard-markets-change negative">-0.03%</span>
                </div>
                <div class="dashboard-markets-item" data-market="gold">
                    <span class="dashboard-markets-name">Gold</span>
                    <span class="dashboard-markets-value">5,208.60</span>
                    <span class="dashboard-markets-change positive">+0.28%</span>
                </div>
                <div class="dashboard-markets-item" data-market="silver">
                    <span class="dashboard-markets-name">Silver</span>
                    <span class="dashboard-markets-value">89.35</span>
                    <span class="dashboard-markets-change positive">+2.01%</span>
                </div>
                <div class="dashboard-markets-item" data-market="usdinr">
                    <span class="dashboard-markets-name">USD/INR</span>
                    <span class="dashboard-markets-value">90.993</span>
                    <span class="dashboard-markets-change positive">+0.02%</span>
                </div>
            </div>
        </div>

        <!-- Charts Grid -->
        <div class="charts-grid">
            <!-- Portfolio Growth Chart -->
            <div class="chart-card">
                <div class="chart-header">
                    <h3 class="chart-title">Portfolio Growth</h3>
                    <select id="portfolioTimeRange" class="form-select" style="width: 120px; padding: 8px 12px;" onchange="updatePortfolioChart(this.value)">
                        <option value="1M">1 Month</option>
                        <option value="3M">3 Months</option>
                        <option value="1Y">1 Year</option>
                    </select>
                </div>
                <div class="chart-container">
                    <canvas id="portfolioChart"></canvas>
                </div>
            </div>

            <!-- Asset Allocation Chart -->
            <div class="chart-card">
                <div class="chart-header">
                    <h3 class="chart-title">Asset Allocation</h3>
                </div>
                <div class="chart-container">
                    <canvas id="allocationChart"></canvas>
                </div>
            </div>

            <!-- Prediction Accuracy Chart -->
            <div class="chart-card">
                <div class="chart-header">
                    <h3 class="chart-title">Prediction Accuracy History</h3>
                </div>
                <div class="chart-container">
                    <canvas id="accuracyChart"></canvas>
                </div>
            </div>

            <!-- Market Sentiment Chart -->
            <div class="chart-card">
                <div class="chart-header">
                    <h3 class="chart-title">Market Sentiment Trends</h3>
                </div>
                <div class="chart-container">
                    <canvas id="sentimentChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Recent Activity -->
        <div class="glass-card" style="padding: 24px; margin-top: 24px;">
            <h3 style="margin-bottom: 20px;">Recent Activity</h3>
            <div style="overflow-x: auto;">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Activity</th>
                            <th>Asset</th>
                            <th>Amount</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>2024-01-15</td>
                            <td>Stock Purchase</td>
                            <td>AAPL</td>
                            <td class="text-green">+$5,000</td>
                            <td><span class="sentiment sentiment-positive">Completed</span></td>
                        </tr>
                        <tr>
                            <td>2024-01-14</td>
                            <td>Prediction Made</td>
                            <td>TSLA</td>
                            <td>-</td>
                            <td><span class="sentiment sentiment-positive">Correct</span></td>
                        </tr>
                        <tr>
                            <td>2024-01-13</td>
                            <td>Dividend Received</td>
                            <td>INFY</td>
                            <td class="text-green">+$245</td>
                            <td><span class="sentiment sentiment-positive">Completed</span></td>
                        </tr>
                        <tr>
                            <td>2024-01-12</td>
                            <td>Course Completed</td>
                            <td>Technical Analysis 101</td>
                            <td>-</td>
                            <td><span class="sentiment sentiment-neutral">Earned Badge</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </main>

    <script src="{% static 'js/auth.js' %}"></script>
    <script src="{% static 'js/news-notification.js' %}"></script>
    <script src="{% static 'js/dashboard.js' %}"></script>
</body>
</html>
